<div #innerHTMLelement>
    <mat-toolbar>
        <span>Gong Elements</span>
        <span class="example-spacer"></span>
    </mat-toolbar>

    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">

        <!-- This is the tree node template for leaf nodes -->
        <mat-tree-node class="node-link" *matTreeNodeDef="let node" matTreeNodePadding>
            <div *ngIf="node.type == 'ROOT_OF_BASIC_FIELDS'">
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                <span>{{node.name}} &nbsp;</span>
            </div>
            <div *ngIf="node.type == 'ROOT_OF_TIME_FIELDS'">
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                <span>{{node.name}} &nbsp;</span>
            </div>
            <div *ngIf="node.type == 'ROOT_OF_POINTER_TO_STRUCT_FIELDS'">
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                <span>{{node.name}} &nbsp;</span>
            </div>
            <div *ngIf="node.type == 'ROOT_OF_SLICE_OF_POINTER_TO_GONG_STRUCT_FIELDS'">
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                <span>{{node.name}} &nbsp;</span>
            </div>
            <div *ngIf="node.type == 'POINTER_TO_STRUCT'">
                <!-- can this link be displayed at all ? -->
                <div *ngIf="node.canBeIncluded == true">
                    <!-- if then else block to deal wether the object is present or not -->
                    <div *ngIf="node.presentInDiagram; then leafPresentBlock else leafNotPresentBlock"></div>

                    <!-- if the element is present, display an icon to allow for the removal of the element -->
                    <ng-template #leafPresentBlock>
                        <!-- use a disabled button to provide padding for tree leaf -->
                        <button mat-icon-button disabled></button>
                        <span>{{node.name}} &nbsp;</span>
                        <mat-icon class="node-link-icon" (click)="removePointerToStructFromDiagram(node)">
                            visibility_off
                        </mat-icon>
                    </ng-template>

                    <!-- -->
                    <ng-template #leafNotPresentBlock>
                        <!-- use a disabled button to provide padding for tree leaf -->
                        <button mat-icon-button disabled></button>
                        <span>{{node.name}} &nbsp;</span>
                        <mat-icon class="node-link-icon" (click)="addPointerToStructToDiagram(node)">
                            visibility
                        </mat-icon>
                    </ng-template>
                </div>
                <div *ngIf="node.canBeIncluded == false">
                    <button mat-icon-button disabled></button>
                    <span>{{node.name}} &nbsp;</span>

                </div>
            </div>
            <div *ngIf="node.type == 'SLICE_OF_POINTER_TO_STRUCT'">
                <div *ngIf="node.canBeIncluded == true">

                    <!-- if then else block to deal wether the object is present or not -->
                    <div *ngIf="node.presentInDiagram; then leafPresentBlock else leafNotPresentBlock"></div>

                    <!-- if the element is present, display an icon to allow for the removal of the element -->
                    <ng-template #leafPresentBlock>
                        <!-- use a disabled button to provide padding for tree leaf -->
                        <button mat-icon-button disabled></button>
                        <span>{{node.name}} &nbsp;</span>
                        <mat-icon class="node-link-icon" (click)="removeSliceOfPointerToStructFromDiagram(node)">
                            visibility_off
                        </mat-icon>
                    </ng-template>

                    <!-- -->
                    <ng-template #leafNotPresentBlock>
                        <!-- use a disabled button to provide padding for tree leaf -->
                        <button mat-icon-button disabled></button>
                        <span>{{node.name}} &nbsp;</span>
                        <mat-icon class="node-link-icon" (click)="addSliceOfPointerToStructToDiagram(node)">
                            visibility
                        </mat-icon>
                    </ng-template>
                </div>
                <div *ngIf="node.canBeIncluded == false">
                    <button mat-icon-button disabled></button>
                    <span>{{node.name}} &nbsp;</span>
                </div>
            </div>
            <div *ngIf="node.type == 'BASIC_FIELD'">
                <div *ngIf="node.canBeIncluded == true">
                    <!-- use a disabled button to provide padding for tree leaf -->
                    <button mat-icon-button disabled></button>
                    <span>{{node.name}} &nbsp;</span>
                    <!-- if then else block to deal wether the object is present or not -->
                    <div *ngIf="node.presentInDiagram; then leafPresentBlock else leafNotPresentBlock"></div>

                    <!-- if the element is present, display an icon to allow for the removal of the element -->
                    <ng-template #leafPresentBlock>
                        <mat-icon class="node-link-icon" (click)="removeBasicFieldFromDiagram(node)">
                            visibility_off
                        </mat-icon>
                    </ng-template>

                    <!-- -->
                    <ng-template #leafNotPresentBlock>
                        <mat-icon class="node-link-icon" (click)="addBasicFieldToDiagram(node)">
                            visibility
                        </mat-icon>
                    </ng-template>
                </div>
                <div *ngIf="node.canBeIncluded == false">
                    <button mat-icon-button disabled></button>
                    <span>{{node.name}} &nbsp;</span>
                </div>
            </div>
            <div *ngIf="node.type == 'TIME_FIELD'">
                <div *ngIf="node.canBeIncluded == true">
                    <!-- use a disabled button to provide padding for tree leaf -->
                    <button mat-icon-button disabled></button>
                    <span>{{node.name}} &nbsp;</span>
                    <!-- if then else block to deal wether the object is present or not -->
                    <div *ngIf="node.presentInDiagram; then leafPresentBlock else leafNotPresentBlock"></div>

                    <!-- if the element is present, display an icon to allow for the removal of the element -->
                    <ng-template #leafPresentBlock>
                        <mat-icon class="node-link-icon" (click)="removeBasicFieldFromDiagram(node)">
                            visibility_off
                        </mat-icon>
                    </ng-template>

                    <!-- -->
                    <ng-template #leafNotPresentBlock>
                        <mat-icon class="node-link-icon" (click)="addBasicFieldToDiagram(node)">
                            visibility
                        </mat-icon>
                    </ng-template>
                </div>
                <div *ngIf="node.canBeIncluded == false">
                    <button mat-icon-button disabled></button>
                    <span>{{node.name}} &nbsp;</span>
                </div>
            </div>
        </mat-tree-node>

        <!-- This is the tree node template for expandable nodes -->
        <mat-tree-node class="node-link" *matTreeNodeDef="let node;when: hasChild" matTreeNodePadding>

            <!-- This is the chevron stuff-->
            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.name">
                <mat-icon class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ?
                    'expand_more' :
                    'chevron_right'
                    }}
                </mat-icon>
            </button>

            <!-- if then else block to deal with present / not present node -->
            <div *ngIf="node.presentInDiagram; then blockForGongStructInstancePresentInDiagram else otherCases"></div>

            <!-- if the gong struct is present in the diagram, have a button to have it removed -->
            <ng-template #blockForGongStructInstancePresentInDiagram>
                <div>
                    <span>{{node.name}} &nbsp;</span>
                </div>
                <mat-icon class="node-link-icon" (click)="removeNodeFromDiagram(node)">
                    visibility_off
                </mat-icon>
            </ng-template>

            <!-- if the gong struct is not present or if it is an expandable of the gong struct -->
            <ng-template #otherCases>

                <!-- if then else block definition node.level == 1 is for gong struct-->
                <div *ngIf="node.level == 1 || node.level == 3; then blockForGongStructInstanceNotPresentInDiagram else otherNodes">
                </div>

                <!-- if this is a gong struct, have it draggable -->
                <ng-template #blockForGongStructInstanceNotPresentInDiagram>
                    <div [cdkDropListDisabled]="false" (cdkDropListDropped)="dropped($event, node)" cdkDropList>
                        <span cdkDrag>{{node.name}}
                            &nbsp;</span>
                    </div>
                </ng-template>

                <!-- if this is not a gong struct, then display the name -->
                <ng-template #otherNodes>
                    <div>
                        <span>{{node.name}} &nbsp;</span>
                    </div>
                </ng-template>
            </ng-template>
        </mat-tree-node>
    </mat-tree>
</div>